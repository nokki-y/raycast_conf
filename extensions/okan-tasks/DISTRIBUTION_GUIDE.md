# おかんタスク確認 - 配布ガイド（管理者向け）

このガイドは、拡張機能を他のユーザーに配布する管理者向けの手順を説明します。

## 📦 配布用パッケージの作成

### 1. リリースパッケージをビルド

```bash
cd extensions/okan-tasks
npm run release
```

このコマンドで `release/okan-tasks-raycast/` ディレクトリが作成されます。

### 2. 作成されるファイル構成

```
release/okan-tasks-raycast/
├── dist/                  # ビルド済みの拡張機能
├── assets/                # アイコンなどのアセット
├── .auth/                 # 認証情報（token.json, credentials.json含む）
├── package.json           # メタデータ
└── INSTALL.md             # エンドユーザー向けインストール手順
```

**重要**: `.auth/`ディレクトリには認証済みの情報が含まれています。

## 🚀 配布手順

### Zipファイルで配布（推奨）

```bash
cd release
zip -r okan-tasks-raycast.zip okan-tasks-raycast/
```

配布先に送付：
- `okan-tasks-raycast.zip` のみ

**メリット**:
- ✅ 配布先での認証作業が不要
- ✅ credentials.jsonを個別共有する必要なし
- ✅ セットアップが非常に簡単

**注意**:
- ⚠️ 認証情報が含まれるため、信頼できる相手のみに配布
- ⚠️ 配布先は同じGoogleアカウントのアクセストークンを共有することになります

### 方法2: 共有フォルダで配布

`release/okan-tasks-raycast/` フォルダをGoogle DriveやDropboxなどの共有フォルダに配置し、配布先にアクセス権を付与。

## 📋 配布先への指示

配布先に以下の手順を伝えます：

---

### インストール手順（配布先向け）

1. **ダウンロード**
   - `okan-tasks-raycast.zip` をダウンロードして解凍
   - または共有フォルダから `okan-tasks-raycast` フォルダをコピー

2. **Raycastにインストール**
   - Raycast Preferences → Extensions → **+** → **Add Extension**
   - `okan-tasks-raycast` フォルダを選択
   - **Install Extension** をクリック

3. **設定**
   - Raycastで `Check Okan Tasks` を検索
   - ⌘ + K → Preferences で設定画面を開く
   - 以下を入力（管理者から共有された値を使用）:
     - Spreadsheet ID
     - Sheet Name
     - Sheet GID
     - My Name（自分の名前）

4. **動作確認**
   - Raycastで `Check Okan Tasks` を実行
   - タスクが表示されればOK！

---

## 🔐 認証情報の管理

### セキュリティに関する重要な注意

配布パッケージには**あなたのGoogleアカウントで認証されたトークン**が含まれています。

**これが意味すること**:
- ✅ 配布先は認証作業不要で即座に使用可能
- ⚠️ 配布先はあなたのGoogleアカウントでスプレッドシートにアクセス
- ⚠️ 配布先が信頼できる相手であることを確認してください

### 推奨される配布方法

1. **社内・チーム内での配布**: 問題なし
2. **信頼できる個人への配布**: 問題なし
3. **不特定多数への配布**: 非推奨

### アクセス権限

配布される認証情報の権限:
- スプレッドシートの**読み取り専用**（`spreadsheets.readonly`）
- 書き込みや削除はできません

## 🔄 アップデート配布

拡張機能を更新する場合：

1. コードを修正
2. `npm run release` で新しいパッケージを作成
3. 配布先に新しいパッケージを送付
4. 配布先は既存の `.auth/` ディレクトリを保持したまま、他のファイルを上書き

`.auth/` ディレクトリの認証情報は保持されるため、再認証は不要です。

## 📊 サポート対応

### よくある問題

**1. 認証エラー**
- `credentials.json` が正しく配置されているか確認
- 認証コードが正しく入力されたか確認

**2. タスクが表示されない**
- Spreadsheet ID が正しいか
- Sheet Name が正しいか（大文字小文字、スペースに注意）
- My Name がスプレッドシートの列ヘッダーと完全一致しているか

**3. 401 Unauthorized エラー**
- 通常は自動リフレッシュされるが、もし発生した場合は再認証を依頼

## 🛠️ 開発者向け補足

### なぜビルド済みを配布するのか

- エンドユーザーにNode.js環境が不要
- セットアップが簡単（ビルド不要）
- 配布が容易（単一フォルダで完結）

### ソースコードからのビルド

開発者や技術者向けには、GitHubリポジトリのREADME.mdを参照してもらい、ソースコードからビルドすることも可能です。

## 📝 配布チェックリスト

配布前に確認：

- [ ] `npm run release` でビルド成功
- [ ] `release/okan-tasks-raycast/` にINSTALL.mdが含まれている
- [ ] `credentials.json` を別途準備
- [ ] 配布先への指示メールを準備
- [ ] テスト環境で動作確認済み

---

このガイドに従って配布すれば、エンドユーザーは開発環境なしで拡張機能を利用できます。
